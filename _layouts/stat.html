<html>
    <head>
        <title>{{page.title}}</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"> </script>
        <!--[if IE]><script src="media/js/excanvas.compiled.js" type="text/javascript"></script><![endif]-->
        <script src="media/js/jquery.flot.min.js" type="text/javascript"></script>
        <script src="media/js/jquery.flot.min.js" type="text/javascript"></script>
        
        <link href="media/css/style.css" rel="stylesheet" />
    </head>
    <body>
        <div id="content">
            <h1>{{page.title}}</h1>
            <div id="placeholder" style="width:600px;height:300px"></div>

            <script>
            {{content}}
            </script>
            
            <script id="source" language="javascript" type="text/javascript">
            $(function () {
                var stripped = {};
                
                for (var key in data[0]) {
                    if (key !== "created")
                        stripped[key] = new Array();
                }

                for (var i=0;i<data.length;i++) {
                    var d = data[i];

                    for (var key in stripped)
                        stripped[key].push([d['created'], d[key]]);
                }

                flot_data = [];
                for (var key in stripped) {
                    var fd = {};
                    fd['data'] = stripped[key];
                    fd['label'] = key;
                    fd['lines'] = { show: true, fill: true };

                    flot_data.push(fd);
                }

                for (var idx in second_axis)
                    flot_data[second_axis[idx]]['yaxis'] = 2;


                $.plot($("#placeholder"),
                    flot_data,
                    {
                        xaxis: {
                            mode: "time"
                        }
                    }
                );
            });
            </script>
        </div>

    </body>
</html>
